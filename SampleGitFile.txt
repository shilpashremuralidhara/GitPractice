Add new code

adding the code from develop branch 
